<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMAT | Applied Materials – Investment Thesis</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

  :root {
    --bg: #0b1120;
    --card: #111827;
    --card-border: #1e293b;
    --text: #e2e8f0;
    --text-muted: #94a3b8;
    --text-dim: #64748b;
    --accent: #3b82f6;
    --green: #10b981;
    --red: #ef4444;
    --amber: #f59e0b;
    --purple: #8b5cf6;
    --cyan: #06b6d4;
    --pink: #ec4899;
    --orange: #f97316;
    --base-color: #3b82f6;
    --bull-color: #10b981;
    --bear-color: #ef4444;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.5;
    min-height: 100vh;
  }

  .container {
    max-width: 1440px;
    margin: 0 auto;
    padding: 24px 32px;
  }

  /* ── Header ── */
  .header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 24px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--card-border);
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: 20px;
  }

  .ticker-badge {
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 28px;
    font-weight: 800;
    letter-spacing: 2px;
  }

  .company-info h1 {
    font-size: 22px;
    font-weight: 700;
    color: var(--text);
  }

  .company-info .subtitle {
    font-size: 13px;
    color: var(--text-muted);
    margin-top: 2px;
  }

  .price-block {
    text-align: right;
  }

  .price-block .current-price {
    font-size: 36px;
    font-weight: 800;
    letter-spacing: -1px;
  }

  .price-block .price-label {
    font-size: 11px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .target-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 6px;
  }

  .target-price {
    font-size: 18px;
    font-weight: 700;
    color: var(--green);
  }

  .upside-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 700;
  }

  .upside-badge.positive { background: rgba(16,185,129,0.15); color: var(--green); }
  .upside-badge.negative { background: rgba(239,68,68,0.15); color: var(--red); }

  /* ── Scenario Toggle ── */
  .scenario-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 24px;
    padding: 12px;
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 12px;
  }

  .scenario-bar .label {
    font-size: 12px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    font-weight: 600;
    margin-right: 8px;
  }

  .scenario-btn {
    padding: 8px 24px;
    border: 2px solid transparent;
    border-radius: 8px;
    background: transparent;
    color: var(--text-muted);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
  }

  .scenario-btn:hover { color: var(--text); background: rgba(255,255,255,0.05); }

  .scenario-btn.active-base { background: rgba(59,130,246,0.15); border-color: var(--base-color); color: var(--base-color); }
  .scenario-btn.active-bull { background: rgba(16,185,129,0.15); border-color: var(--bull-color); color: var(--bull-color); }
  .scenario-btn.active-bear { background: rgba(239,68,68,0.15); border-color: var(--bear-color); color: var(--bear-color); }

  .scenario-btn .btn-detail {
    display: block;
    font-size: 10px;
    font-weight: 400;
    color: var(--text-dim);
    margin-top: 1px;
  }

  /* ── Cards / Grid ── */
  .grid {
    display: grid;
    gap: 20px;
    margin-bottom: 20px;
  }

  .grid-2 { grid-template-columns: repeat(2, 1fr); }
  .grid-3 { grid-template-columns: repeat(3, 1fr); }
  .grid-4 { grid-template-columns: repeat(4, 1fr); }
  .grid-2-1 { grid-template-columns: 2fr 1fr; }
  .grid-1-2 { grid-template-columns: 1fr 2fr; }

  .card {
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 20px;
    position: relative;
    overflow: hidden;
  }

  .card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }

  .card-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.8px;
  }

  .card-tag {
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .card-tag.blue { background: rgba(59,130,246,0.15); color: var(--accent); }
  .card-tag.green { background: rgba(16,185,129,0.15); color: var(--green); }

  /* ── KPI Row ── */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 16px;
    margin-bottom: 20px;
  }

  .kpi {
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 10px;
    padding: 16px 20px;
    text-align: center;
  }

  .kpi .kpi-label {
    font-size: 11px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 500;
    margin-bottom: 6px;
  }

  .kpi .kpi-value {
    font-size: 26px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .kpi .kpi-sub {
    font-size: 11px;
    color: var(--text-dim);
    margin-top: 2px;
  }

  /* ── Thesis Section ── */
  .thesis-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 20px;
  }

  .thesis-card {
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 10px;
    padding: 20px;
    border-left: 3px solid;
  }

  .thesis-card.pillar-1 { border-left-color: var(--accent); }
  .thesis-card.pillar-2 { border-left-color: var(--cyan); }
  .thesis-card.pillar-3 { border-left-color: var(--purple); }

  .thesis-card .pillar-num {
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 6px;
  }

  .thesis-card.pillar-1 .pillar-num { color: var(--accent); }
  .thesis-card.pillar-2 .pillar-num { color: var(--cyan); }
  .thesis-card.pillar-3 .pillar-num { color: var(--purple); }

  .thesis-card h3 {
    font-size: 14px;
    font-weight: 700;
    margin-bottom: 8px;
    line-height: 1.3;
  }

  .thesis-card p {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.6;
  }

  /* ── Chart Canvas ── */
  .chart-wrap {
    position: relative;
    width: 100%;
    height: 280px;
  }

  .chart-wrap canvas {
    width: 100% !important;
    height: 100% !important;
  }

  .chart-wrap-sm { height: 220px; }
  .chart-wrap-lg { height: 340px; }

  /* ── Table ── */
  .comp-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }

  .comp-table th {
    text-align: left;
    color: var(--text-dim);
    font-weight: 600;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--card-border);
  }

  .comp-table th:not(:first-child) { text-align: right; }

  .comp-table td {
    padding: 10px 12px;
    border-bottom: 1px solid rgba(30,41,59,0.5);
  }

  .comp-table td:not(:first-child) { text-align: right; font-variant-numeric: tabular-nums; }

  .comp-table tr.highlight { background: rgba(59,130,246,0.08); }
  .comp-table tr.highlight td:first-child { font-weight: 700; color: var(--accent); }

  /* ── Catalyst Timeline ── */
  .timeline {
    position: relative;
    padding-left: 24px;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 8px;
    top: 4px;
    bottom: 4px;
    width: 2px;
    background: var(--card-border);
  }

  .timeline-item {
    position: relative;
    margin-bottom: 16px;
    padding-left: 20px;
  }

  .timeline-item::before {
    content: '';
    position: absolute;
    left: -20px;
    top: 6px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid var(--accent);
    background: var(--bg);
  }

  .timeline-item.active::before { background: var(--accent); }

  .timeline-item .tl-date {
    font-size: 11px;
    color: var(--accent);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .timeline-item .tl-text {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 2px;
    line-height: 1.4;
  }

  /* ── Risk/Reward Gauge ── */
  .rr-visual {
    display: flex;
    align-items: stretch;
    gap: 0;
    height: 56px;
    border-radius: 8px;
    overflow: hidden;
    margin: 16px 0 12px;
  }

  .rr-segment {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    color: white;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    flex-direction: column;
    gap: 2px;
  }

  .rr-segment .rr-label { font-size: 9px; font-weight: 500; opacity: 0.85; text-transform: uppercase; letter-spacing: 0.5px; }

  /* ── Football Field ── */
  .football-field {
    position: relative;
    height: 80px;
    margin: 20px 0 12px;
    background: rgba(255,255,255,0.03);
    border-radius: 8px;
  }

  .ff-bar {
    position: absolute;
    top: 20px;
    height: 40px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.4s ease;
  }

  .ff-marker {
    position: absolute;
    top: 8px;
    bottom: 0px;
    width: 3px;
    border-radius: 2px;
    z-index: 10;
  }

  .ff-label {
    position: absolute;
    font-size: 11px;
    font-weight: 700;
    white-space: nowrap;
  }

  .ff-label.top { top: 2px; }
  .ff-label.bottom { bottom: -2px; }

  /* ── Footer ── */
  .footer {
    text-align: center;
    padding: 24px;
    color: var(--text-dim);
    font-size: 11px;
    border-top: 1px solid var(--card-border);
    margin-top: 24px;
  }

  /* ── Responsive ── */
  @media (max-width: 1200px) {
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .kpi-row { grid-template-columns: repeat(3, 1fr); }
  }

  @media (max-width: 900px) {
    .grid-2, .grid-3, .grid-2-1, .grid-1-2 { grid-template-columns: 1fr; }
    .thesis-grid { grid-template-columns: 1fr; }
    .kpi-row { grid-template-columns: repeat(2, 1fr); }
    .header { flex-direction: column; gap: 16px; }
  }

  /* ── Animations ── */
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .card, .kpi, .thesis-card { animation: fadeIn 0.4s ease both; }

  /* ── Variance table ── */
  .var-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
    margin-top: 8px;
  }

  .var-table th {
    text-align: right;
    color: var(--text-dim);
    font-weight: 600;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 6px 10px;
    border-bottom: 1px solid var(--card-border);
  }

  .var-table th:first-child { text-align: left; }

  .var-table td {
    padding: 7px 10px;
    text-align: right;
    font-variant-numeric: tabular-nums;
    border-bottom: 1px solid rgba(30,41,59,0.3);
  }

  .var-table td:first-child { text-align: left; color: var(--text-muted); }

  .var-positive { color: var(--green); }
  .var-negative { color: var(--red); }
</style>
</head>
<body>
<div class="container">

  <!-- ════════ HEADER ════════ -->
  <div class="header">
    <div class="header-left">
      <div class="ticker-badge">AMAT</div>
      <div class="company-info">
        <h1>Applied Materials, Inc.</h1>
        <div class="subtitle">Wafer Fab Equipment &bull; Semiconductors &bull; February 2026</div>
      </div>
    </div>
    <div class="price-block">
      <div class="price-label">Current Price (Feb 4, 2026)</div>
      <div class="current-price">$323.11</div>
      <div class="target-row">
        <span class="price-label" style="margin-right:4px">Target</span>
        <span class="target-price" id="headerTarget">$431</span>
        <span class="upside-badge positive" id="headerUpside">+33.4%</span>
      </div>
    </div>
  </div>

  <!-- ════════ SCENARIO TOGGLE ════════ -->
  <div class="scenario-bar">
    <span class="label">Scenario</span>
    <button class="scenario-btn active-base" data-case="base" onclick="switchCase('base')">
      Base <span class="btn-detail">$431 &bull; 30x FY28E</span>
    </button>
    <button class="scenario-btn" data-case="bull" onclick="switchCase('bull')">
      Bull <span class="btn-detail">$534 &bull; 32x FY28E</span>
    </button>
    <button class="scenario-btn" data-case="bear" onclick="switchCase('bear')">
      Bear <span class="btn-detail">$219 &bull; 26x FY28E</span>
    </button>
  </div>

  <!-- ════════ KPI ROW ════════ -->
  <div class="kpi-row">
    <div class="kpi">
      <div class="kpi-label">Price Target</div>
      <div class="kpi-value" id="kpiTarget" style="color:var(--green)">$431</div>
      <div class="kpi-sub" id="kpiUpside">+33.4% upside</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">FY28E EPS</div>
      <div class="kpi-value" id="kpiEPS">$14.37</div>
      <div class="kpi-sub" id="kpiPE">30x P/E</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">FY28E Revenue</div>
      <div class="kpi-value" id="kpiRev">$37.0B</div>
      <div class="kpi-sub" id="kpiRevGrowth">+9.2% yoy</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">FY27E Rev Growth</div>
      <div class="kpi-value" id="kpiRev27">16.4%</div>
      <div class="kpi-sub" id="kpiRev27Sub">vs. consensus 11.8%</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Prob-Adj Price</div>
      <div class="kpi-value" style="color:var(--green)">$409</div>
      <div class="kpi-sub">+26.6% expected</div>
    </div>
  </div>

  <!-- ════════ THESIS PILLARS ════════ -->
  <div class="thesis-grid">
    <div class="thesis-card pillar-1">
      <div class="pillar-num">Pillar 1</div>
      <h3>GAA + BSPDN Intensity Shift</h3>
      <p>FinFET &rarr; Gate-All-Around and Backside Power Delivery transitions drive structural shift to materials engineering. AMAT claims ~50% SAM share with $1B incremental revenue per 100k wafers. FY25 GAA revenue of $4.5B expected to grow to $6-8B FY26, $9-10.5B FY27.</p>
    </div>
    <div class="thesis-card pillar-2">
      <div class="pillar-num">Pillar 2</div>
      <h3>Memory Capex Inflection</h3>
      <p>AI-driven DRAM demand (HBM + server) creates structural supply/demand mismatch. 1c node transition, HBM4/4E with hybrid bonding, and capacity expansion across Micron ($20B), Samsung, and Hynix (mid-30% intensity) drive WFE inflection from 2H26.</p>
    </div>
    <div class="thesis-card pillar-3">
      <div class="pillar-num">Pillar 3</div>
      <h3>China Risk Bounded</h3>
      <p>$600M FY26 export control impact quantified and base-cased. Street assumes extended ICAPS weakness from China, enabling upside from ex-China ICAPS recovery. Non-China cyclical recovery in mature-logic possible mid-to-high single-digit market growth.</p>
    </div>
  </div>

  <!-- ════════ ROW 1: Revenue Build + Consensus Variance ════════ -->
  <div class="grid grid-2" style="margin-bottom:20px">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Revenue Build by Segment ($M)</span>
        <span class="card-tag blue" id="tagRevBuild">Base Case</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartRevBuild"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Internal vs. Consensus Estimates</span>
        <span class="card-tag green">Variance</span>
      </div>
      <div class="chart-wrap chart-wrap-sm">
        <canvas id="chartConsensus"></canvas>
      </div>
      <table class="var-table" id="varianceTable">
        <thead>
          <tr><th></th><th>FY26E</th><th>FY27E</th><th>FY28E</th></tr>
        </thead>
        <tbody id="varianceBody"></tbody>
      </table>
    </div>
  </div>

  <!-- ════════ ROW 2: EPS Path + Margin Trajectory ════════ -->
  <div class="grid grid-2" style="margin-bottom:20px">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Diluted EPS Trajectory</span>
        <span class="card-tag blue" id="tagEPS">Base Case</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartEPS"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Semi Systems Revenue by End Market ($M)</span>
        <span class="card-tag blue" id="tagSemi">Base Case</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartSemiMix"></canvas>
      </div>
    </div>
  </div>

  <!-- ════════ ROW 3: Margins + Geo Revenue ════════ -->
  <div class="grid grid-2" style="margin-bottom:20px">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Margin Trajectory (%)</span>
        <span class="card-tag blue" id="tagMargin">Base Case</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartMargins"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Geographic Revenue Mix – FY25 Actual</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartGeo"></canvas>
      </div>
    </div>
  </div>

  <!-- ════════ ROW 4: Valuation Football Field + R/R ════════ -->
  <div class="grid grid-2" style="margin-bottom:20px">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Valuation Range – 12-18 Month Price Targets</span>
      </div>
      <div style="position:relative;height:160px;margin:20px 0">
        <!-- Football field rendered in JS -->
        <canvas id="chartFootball"></canvas>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:12px;color:var(--text-muted);margin-top:8px">
        <span>Bear: <strong style="color:var(--red)">$219</strong> (26x FY28E)</span>
        <span>Current: <strong>$323</strong></span>
        <span>Base: <strong style="color:var(--accent)">$431</strong> (30x FY28E)</span>
        <span>Bull: <strong style="color:var(--green)">$534</strong> (32x FY28E)</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Risk / Reward Probability</span>
      </div>
      <div class="rr-visual">
        <div class="rr-segment" style="flex:20;background:linear-gradient(135deg,#dc2626,#ef4444)">
          <span class="rr-label">Bear 20%</span>
          <span>$219</span>
        </div>
        <div class="rr-segment" style="flex:60;background:linear-gradient(135deg,#2563eb,#3b82f6)">
          <span class="rr-label">Base 60%</span>
          <span>$431</span>
        </div>
        <div class="rr-segment" style="flex:20;background:linear-gradient(135deg,#059669,#10b981)">
          <span class="rr-label">Bull 20%</span>
          <span>$534</span>
        </div>
      </div>
      <div style="text-align:center;margin:16px 0 8px">
        <span style="font-size:12px;color:var(--text-dim)">Probability-Adjusted Price</span>
        <div style="font-size:32px;font-weight:800;color:var(--green)">$409</div>
        <div style="font-size:13px;color:var(--green)">+26.6% expected return</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:12px;text-align:center;font-size:12px">
        <div>
          <div style="color:var(--red);font-weight:600">-32.3%</div>
          <div style="color:var(--text-dim);font-size:10px">Bear downside</div>
        </div>
        <div>
          <div style="color:var(--accent);font-weight:600">+33.4%</div>
          <div style="color:var(--text-dim);font-size:10px">Base upside</div>
        </div>
        <div>
          <div style="color:var(--green);font-weight:600">+65.3%</div>
          <div style="color:var(--text-dim);font-size:10px">Bull upside</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ════════ ROW 5: Peer Comps + Catalysts ════════ -->
  <div class="grid grid-2" style="margin-bottom:20px">
    <div class="card">
      <div class="card-header">
        <span class="card-title">WFE Peer Group Valuation Comps</span>
      </div>
      <table class="comp-table">
        <thead>
          <tr><th>Company</th><th>FY25 Rev</th><th>Rev Gr%</th><th>FY26E P/E</th><th>FY27E P/E</th><th>FY28E P/E</th></tr>
        </thead>
        <tbody>
          <tr class="highlight">
            <td>AMAT</td><td>$28.4B</td><td>+4.4%</td><td>30.9x</td><td>25.2x</td><td>22.5x</td>
          </tr>
          <tr>
            <td>LRCX</td><td>$18.4B</td><td>+23.7%</td><td>44.7x</td><td>34.2x</td><td>29.8x</td>
          </tr>
          <tr>
            <td>KLAC</td><td>$12.2B</td><td>+23.9%</td><td>38.7x</td><td>30.7x</td><td>27.4x</td>
          </tr>
          <tr>
            <td>ASML</td><td>$24.5B</td><td>+12.4%</td><td>41.4x</td><td>32.3x</td><td>27.2x</td>
          </tr>
        </tbody>
      </table>
      <div style="margin-top:16px">
        <div class="chart-wrap chart-wrap-sm">
          <canvas id="chartPeerPE"></canvas>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Event Path &amp; Catalysts</span>
      </div>
      <div class="timeline" style="margin-top:8px">
        <div class="timeline-item active">
          <div class="tl-date">Q1 FY26 (Feb 2026)</div>
          <div class="tl-text">Earnings print &mdash; China/ICAPS downside update, commentary on node-transition timing and DRAM order visibility</div>
        </div>
        <div class="timeline-item">
          <div class="tl-date">Q2 FY26 (May 2026)</div>
          <div class="tl-text">Continued ICAPS digestion read-through, TSMC N2P/A16 tool delivery commentary, memory capex revision signals</div>
        </div>
        <div class="timeline-item">
          <div class="tl-date">2H26 &mdash; Inflection Window</div>
          <div class="tl-text"><strong>Key catalyst:</strong> GAA mass-production + BSPDN initial-production tool deliveries, DRAM capacity adds. Orders affirm or negate positive inflection thesis</div>
        </div>
        <div class="timeline-item">
          <div class="tl-date">FY27 (CY2027)</div>
          <div class="tl-text">N2P, A16, SF2, 18A-P mass production ramps; cleanroom constraints ease; DRAM greenfield expansion; estimate revisions cycle</div>
        </div>
        <div class="timeline-item">
          <div class="tl-date">Ongoing Datapoints</div>
          <div class="tl-text">TSMC/Intel/Samsung capex guidance, memory supplier capex revisions, WFE market-size estimate revisions from SEMI, peer commentary</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ════════ ROW 6: All-Scenario Overlay + Driver Assumptions ════════ -->
  <div class="grid grid-2">
    <div class="card">
      <div class="card-header">
        <span class="card-title">All-Scenario Revenue Overlay ($M)</span>
      </div>
      <div class="chart-wrap">
        <canvas id="chartOverlay"></canvas>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <span class="card-title">Key Driver Assumptions by Scenario</span>
      </div>
      <div class="chart-wrap chart-wrap-lg" style="height:360px">
        <canvas id="chartDrivers"></canvas>
      </div>
    </div>
  </div>

  <div class="footer">
    Applied Materials (AMAT) Investment Summary &bull; Prepared February 2026 &bull; For discussion purposes only &bull; Built with Claude Code
  </div>

</div>

<script>
// ══════════════════════════════════════════
//  DATA
// ══════════════════════════════════════════

const CURRENT_PRICE = 323.11;

const HIST = {
  years: ['FY19','FY20','FY21','FY22','FY23','FY24','FY25'],
  revenue: [14608, 17202, 23063, 25785, 26517, 27176, 28368],
  semi: [9027, 11367, 16286, 18797, 19698, 19911, 20798],
  ags: [3854, 4155, 5013, 5543, 5732, 6225, 6385],
  foundry: [4694, 6707, 9772, 12406, 15167, 13539, 13935],
  dram: [1986, 2273, 3094, 3571, 3349, 5575, 5407],
  nand: [2347, 2387, 2443, 2820, 1182, 796, 1456],
  eps: [2.86, 3.92, 6.41, 7.44, 8.11, 8.61, 8.66],
  grossMargin: [43.7, 44.7, 47.3, 46.5, 46.7, 47.5, 48.7],
  ebitdaMargin: [25.4, 27.6, 31.6, 31.9, 30.8, 30.4, 30.8],
};

const SCENARIOS = {
  base: {
    label: 'Base Case',
    color: '#3b82f6',
    colorRgba: 'rgba(59,130,246,',
    target: 431, pe: 30, prob: 60,
    revenue: [29134, 33904, 37007],
    semi: [21254, 25343, 27843],
    foundry: [14025, 17111, 19164],
    dram: [5595, 6434, 6756],
    nand: [1634, 1797, 1923],
    ags: [6706, 7377, 7967],
    eps: [10.45, 12.83, 14.37],
    grossMargin: [48.7, 49.7, 49.8],
    ebitdaMargin: [31.0, 31.5, 31.5],
    semiGM: [54.2, 55.0, 55.0],
  },
  bull: {
    label: 'Bull Case',
    color: '#10b981',
    colorRgba: 'rgba(16,185,129,',
    target: 534, pe: 32, prob: 20,
    revenue: [30347, 37073, 41555],
    semi: [22433, 28327, 32130],
    foundry: [14925, 19401, 22311],
    dram: [5803, 6963, 7660],
    nand: [1707, 1963, 2159],
    ags: [6740, 7549, 8228],
    eps: [11.24, 14.49, 16.69],
    grossMargin: [48.4, 49.7, 50.6],
    ebitdaMargin: [32.0, 32.0, 32.0],
    semiGM: [54.9, 55.5, 56.0],
  },
  bear: {
    label: 'Bear Case',
    color: '#ef4444',
    colorRgba: 'rgba(239,68,68,',
    target: 219, pe: 26, prob: 20,
    revenue: [27995, 29399, 30134],
    semi: [20304, 21490, 22010],
    foundry: [13369, 14439, 14872],
    dram: [5396, 5450, 5505],
    nand: [1539, 1601, 1633],
    ags: [6517, 6713, 6927],
    eps: [8.21, 8.32, 8.41],
    grossMargin: [45.3, 45.9, 45.5],
    ebitdaMargin: [29.0, 29.0, 29.0],
    semiGM: [53.5, 54.0, 53.5],
  }
};

const CONSENSUS = {
  revenue: [28701, 32088, 33510],
  semi: [21013, 23544, 24507],
  ags: [6549, 7350, 7810],
  eps: [9.70, 11.99, 12.76],
  grossMargin: [48.6, 48.4, 45.4],
};

const GEO = {
  labels: ['China','Taiwan','Korea','Japan','US','SE Asia','Europe'],
  values: [8529, 6857, 5608, 2273, 3063, 1076, 962],
  colors: ['#ef4444','#3b82f6','#8b5cf6','#f59e0b','#10b981','#06b6d4','#ec4899'],
};

const EST_YEARS = ['FY26E','FY27E','FY28E'];
const ALL_YEARS = [...HIST.years, ...EST_YEARS];

let currentCase = 'base';
let charts = {};

// ══════════════════════════════════════════
//  CHART.JS DEFAULTS
// ══════════════════════════════════════════

Chart.defaults.color = '#94a3b8';
Chart.defaults.borderColor = 'rgba(30,41,59,0.6)';
Chart.defaults.font.family = "'Inter', sans-serif";
Chart.defaults.font.size = 11;
Chart.defaults.plugins.legend.labels.boxWidth = 12;
Chart.defaults.plugins.legend.labels.boxHeight = 12;
Chart.defaults.plugins.legend.labels.padding = 16;
Chart.defaults.plugins.tooltip.backgroundColor = '#1e293b';
Chart.defaults.plugins.tooltip.titleColor = '#e2e8f0';
Chart.defaults.plugins.tooltip.bodyColor = '#94a3b8';
Chart.defaults.plugins.tooltip.borderColor = '#334155';
Chart.defaults.plugins.tooltip.borderWidth = 1;
Chart.defaults.plugins.tooltip.cornerRadius = 8;
Chart.defaults.plugins.tooltip.padding = 10;

// ══════════════════════════════════════════
//  HELPERS
// ══════════════════════════════════════════

function fmt(n, dec=0) { return n.toLocaleString('en-US', {minimumFractionDigits:dec, maximumFractionDigits:dec}); }
function fmtB(n) { return '$' + (n/1000).toFixed(1) + 'B'; }
function pct(n) { return (n > 0 ? '+' : '') + n.toFixed(1) + '%'; }
function getS() { return SCENARIOS[currentCase]; }

// ══════════════════════════════════════════
//  INIT ALL CHARTS
// ══════════════════════════════════════════

function initCharts() {
  initRevBuild();
  initConsensus();
  initEPS();
  initSemiMix();
  initMargins();
  initGeo();
  initFootball();
  initPeerPE();
  initOverlay();
  initDrivers();
  updateVarianceTable();
}

// ── Revenue Build (Stacked Bar) ──
function initRevBuild() {
  const s = getS();
  const allFoundry = [...HIST.foundry, ...s.foundry];
  const allDram = [...HIST.dram, ...s.dram];
  const allNand = [...HIST.nand, ...s.nand];
  const allAgs = [...HIST.ags, ...s.ags];

  charts.revBuild = new Chart(document.getElementById('chartRevBuild'), {
    type: 'bar',
    data: {
      labels: ALL_YEARS,
      datasets: [
        { label: 'Foundry/Logic', data: allFoundry, backgroundColor: '#3b82f6', borderRadius: 2 },
        { label: 'DRAM', data: allDram, backgroundColor: '#06b6d4', borderRadius: 2 },
        { label: 'NAND', data: allNand, backgroundColor: '#8b5cf6', borderRadius: 2 },
        { label: 'AGS + Other', data: allAgs.map((v,i) => {
          const corp = i < HIST.years.length ? [1727,1680,1764,1445,1087,1040,1185][i] : 1175;
          return v + corp;
        }), backgroundColor: '#f59e0b', borderRadius: 2 },
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: ctx => `${ctx.dataset.label}: $${fmt(ctx.raw)}M`,
            footer: items => {
              const total = items.reduce((sum, i) => sum + i.raw, 0);
              return `Total: $${fmt(total)}M`;
            }
          }
        }
      },
      scales: {
        x: { stacked: true, grid: { display: false } },
        y: {
          stacked: true,
          ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'B' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Consensus Comparison ──
function initConsensus() {
  const s = getS();
  charts.consensus = new Chart(document.getElementById('chartConsensus'), {
    type: 'bar',
    data: {
      labels: EST_YEARS,
      datasets: [
        {
          label: 'Internal',
          data: s.revenue,
          backgroundColor: s.color,
          borderRadius: 4,
        },
        {
          label: 'Consensus',
          data: CONSENSUS.revenue,
          backgroundColor: '#475569',
          borderRadius: 4,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: ctx => `${ctx.dataset.label}: $${fmt(ctx.raw)}M`
          }
        }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          beginAtZero: false,
          min: 25000,
          ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'B' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── EPS Trajectory ──
function initEPS() {
  const s = getS();
  charts.eps = new Chart(document.getElementById('chartEPS'), {
    type: 'line',
    data: {
      labels: ALL_YEARS,
      datasets: [
        {
          label: 'Internal EPS',
          data: [...HIST.eps, ...s.eps],
          borderColor: s.color,
          backgroundColor: s.colorRgba + '0.1)',
          borderWidth: 3,
          pointRadius: 4,
          pointBackgroundColor: s.color,
          fill: true,
          tension: 0.3,
        },
        {
          label: 'Consensus EPS',
          data: [...Array(HIST.years.length).fill(null), ...CONSENSUS.eps],
          borderColor: '#475569',
          borderDash: [6, 4],
          borderWidth: 2,
          pointRadius: 4,
          pointBackgroundColor: '#475569',
          fill: false,
          tension: 0.3,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: ctx => ctx.raw !== null ? `${ctx.dataset.label}: $${ctx.raw.toFixed(2)}` : ''
          }
        }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          ticks: { callback: v => '$' + v.toFixed(0) },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Semi Systems Mix (Stacked Bar) ──
function initSemiMix() {
  const s = getS();
  charts.semiMix = new Chart(document.getElementById('chartSemiMix'), {
    type: 'bar',
    data: {
      labels: ALL_YEARS,
      datasets: [
        { label: 'Foundry/Logic', data: [...HIST.foundry, ...s.foundry], backgroundColor: '#3b82f6', borderRadius: 2 },
        { label: 'DRAM', data: [...HIST.dram, ...s.dram], backgroundColor: '#06b6d4', borderRadius: 2 },
        { label: 'NAND', data: [...HIST.nand, ...s.nand], backgroundColor: '#8b5cf6', borderRadius: 2 },
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: ctx => `${ctx.dataset.label}: $${fmt(ctx.raw)}M`,
            footer: items => {
              const total = items.reduce((sum, i) => sum + i.raw, 0);
              return `Semi Systems Total: $${fmt(total)}M`;
            }
          }
        }
      },
      scales: {
        x: { stacked: true, grid: { display: false } },
        y: {
          stacked: true,
          ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'B' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Margin Trajectory ──
function initMargins() {
  const s = getS();
  charts.margins = new Chart(document.getElementById('chartMargins'), {
    type: 'line',
    data: {
      labels: ALL_YEARS,
      datasets: [
        {
          label: 'Gross Margin',
          data: [...HIST.grossMargin, ...s.grossMargin],
          borderColor: '#3b82f6',
          borderWidth: 2.5,
          pointRadius: 3,
          pointBackgroundColor: '#3b82f6',
          tension: 0.3,
        },
        {
          label: 'EBITDA Margin',
          data: [...HIST.ebitdaMargin, ...s.ebitdaMargin],
          borderColor: '#10b981',
          borderWidth: 2.5,
          pointRadius: 3,
          pointBackgroundColor: '#10b981',
          tension: 0.3,
        },
        {
          label: 'Semi Systems GM',
          data: [...[null,null,null,null,null,null, 54.2], ...s.semiGM],
          borderColor: '#f59e0b',
          borderDash: [5,3],
          borderWidth: 2,
          pointRadius: 3,
          pointBackgroundColor: '#f59e0b',
          tension: 0.3,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: { label: ctx => ctx.raw !== null ? `${ctx.dataset.label}: ${ctx.raw.toFixed(1)}%` : '' }
        }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          min: 20,
          max: 60,
          ticks: { callback: v => v + '%' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Geographic Mix (Doughnut) ──
function initGeo() {
  charts.geo = new Chart(document.getElementById('chartGeo'), {
    type: 'doughnut',
    data: {
      labels: GEO.labels,
      datasets: [{
        data: GEO.values,
        backgroundColor: GEO.colors,
        borderColor: '#111827',
        borderWidth: 2,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      cutout: '55%',
      plugins: {
        legend: { position: 'right', labels: { padding: 12 } },
        tooltip: {
          callbacks: {
            label: ctx => {
              const total = ctx.dataset.data.reduce((a,b) => a+b, 0);
              const pctVal = (ctx.raw / total * 100).toFixed(1);
              return `${ctx.label}: $${fmt(ctx.raw)}M (${pctVal}%)`;
            }
          }
        }
      }
    }
  });
}

// ── Football Field (Horizontal Bar) ──
function initFootball() {
  const min = 150, max = 600;
  charts.football = new Chart(document.getElementById('chartFootball'), {
    type: 'bar',
    data: {
      labels: ['Price Target Range'],
      datasets: [
        {
          label: 'Bear-to-Base',
          data: [[219, 431]],
          backgroundColor: 'rgba(59,130,246,0.2)',
          borderColor: '#3b82f6',
          borderWidth: 1,
          borderRadius: 6,
          borderSkipped: false,
          barPercentage: 0.5,
        },
        {
          label: 'Base-to-Bull',
          data: [[431, 534]],
          backgroundColor: 'rgba(16,185,129,0.2)',
          borderColor: '#10b981',
          borderWidth: 1,
          borderRadius: 6,
          borderSkipped: false,
          barPercentage: 0.5,
        }
      ]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: { enabled: false },
        annotation: {
          annotations: {
            currentLine: {
              type: 'line',
              xMin: 323.11,
              xMax: 323.11,
              borderColor: '#f59e0b',
              borderWidth: 3,
              borderDash: [6, 3],
              label: {
                display: true,
                content: 'Current $323',
                position: 'start',
                backgroundColor: 'rgba(245,158,11,0.9)',
                color: '#fff',
                font: { size: 11, weight: 'bold' },
                padding: 4,
              }
            },
            bearLabel: {
              type: 'label',
              xValue: 219,
              yValue: 0,
              content: ['$219'],
              color: '#ef4444',
              font: { size: 13, weight: 'bold' },
              position: { y: 'end' },
              yAdjust: 30,
            },
            baseLabel: {
              type: 'label',
              xValue: 431,
              yValue: 0,
              content: ['$431'],
              color: '#3b82f6',
              font: { size: 13, weight: 'bold' },
              position: { y: 'end' },
              yAdjust: 30,
            },
            bullLabel: {
              type: 'label',
              xValue: 534,
              yValue: 0,
              content: ['$534'],
              color: '#10b981',
              font: { size: 13, weight: 'bold' },
              position: { y: 'end' },
              yAdjust: 30,
            },
            probLabel: {
              type: 'label',
              xValue: 409,
              yValue: 0,
              content: ['$409 Prob-Adj'],
              color: '#f59e0b',
              font: { size: 11, weight: '600' },
              position: { y: 'start' },
              yAdjust: -20,
            },
          }
        }
      },
      scales: {
        x: {
          min: 150,
          max: 600,
          ticks: { callback: v => '$' + v },
          grid: { color: 'rgba(30,41,59,0.4)' },
        },
        y: { display: false }
      }
    }
  });
}

// ── Peer P/E Comparison ──
function initPeerPE() {
  charts.peerPE = new Chart(document.getElementById('chartPeerPE'), {
    type: 'bar',
    data: {
      labels: ['AMAT','LRCX','KLAC','ASML'],
      datasets: [
        { label: 'FY26E P/E', data: [30.9, 44.7, 38.7, 41.4], backgroundColor: '#3b82f6', borderRadius: 3 },
        { label: 'FY27E P/E', data: [25.2, 34.2, 30.7, 32.3], backgroundColor: '#06b6d4', borderRadius: 3 },
        { label: 'FY28E P/E', data: [22.5, 29.8, 27.4, 27.2], backgroundColor: '#8b5cf6', borderRadius: 3 },
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: { callbacks: { label: ctx => `${ctx.dataset.label}: ${ctx.raw}x` } }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          ticks: { callback: v => v + 'x' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── All-Scenario Overlay ──
function initOverlay() {
  charts.overlay = new Chart(document.getElementById('chartOverlay'), {
    type: 'line',
    data: {
      labels: [...HIST.years, ...EST_YEARS],
      datasets: [
        {
          label: 'Bull',
          data: [...HIST.revenue, ...SCENARIOS.bull.revenue],
          borderColor: '#10b981',
          backgroundColor: 'rgba(16,185,129,0.05)',
          borderWidth: 2,
          pointRadius: 3,
          pointBackgroundColor: '#10b981',
          fill: '+1',
          tension: 0.3,
        },
        {
          label: 'Base',
          data: [...HIST.revenue, ...SCENARIOS.base.revenue],
          borderColor: '#3b82f6',
          borderWidth: 3,
          pointRadius: 4,
          pointBackgroundColor: '#3b82f6',
          tension: 0.3,
        },
        {
          label: 'Bear',
          data: [...HIST.revenue, ...SCENARIOS.bear.revenue],
          borderColor: '#ef4444',
          backgroundColor: 'rgba(239,68,68,0.05)',
          borderWidth: 2,
          pointRadius: 3,
          pointBackgroundColor: '#ef4444',
          fill: '-1',
          tension: 0.3,
        },
        {
          label: 'Consensus',
          data: [...Array(HIST.years.length).fill(null), ...CONSENSUS.revenue],
          borderColor: '#64748b',
          borderDash: [6, 4],
          borderWidth: 2,
          pointRadius: 3,
          pointStyle: 'rectRot',
          pointBackgroundColor: '#64748b',
          tension: 0.3,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: { label: ctx => ctx.raw !== null ? `${ctx.dataset.label}: $${fmt(ctx.raw)}M` : '' }
        }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          ticks: { callback: v => '$' + (v/1000).toFixed(0) + 'B' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Driver Assumptions Radar-style Grouped Bar ──
function initDrivers() {
  const drivers = [
    'Foundry/Logic\nYoY FY27E',
    'DRAM\nYoY FY27E',
    'NAND\nYoY FY27E',
    'AGS\nYoY FY27E',
    'Semi GM\nFY28E',
    'EBITDA Mgn\nFY28E',
  ];

  charts.drivers = new Chart(document.getElementById('chartDrivers'), {
    type: 'bar',
    data: {
      labels: drivers,
      datasets: [
        {
          label: 'Bear',
          data: [8, 1, 4, 3, 53.5, 29.0],
          backgroundColor: 'rgba(239,68,68,0.7)',
          borderRadius: 3,
        },
        {
          label: 'Base',
          data: [22, 15, 10, 10, 55.0, 31.5],
          backgroundColor: 'rgba(59,130,246,0.7)',
          borderRadius: 3,
        },
        {
          label: 'Bull',
          data: [30, 20, 15, 12, 56.0, 32.0],
          backgroundColor: 'rgba(16,185,129,0.7)',
          borderRadius: 3,
        },
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          callbacks: {
            label: ctx => {
              const unit = ctx.dataIndex < 4 ? '%' : '%';
              return `${ctx.dataset.label}: ${ctx.raw}${unit}`;
            }
          }
        }
      },
      scales: {
        x: { grid: { display: false } },
        y: {
          ticks: { callback: v => v + '%' },
          grid: { color: 'rgba(30,41,59,0.4)' }
        }
      }
    }
  });
}

// ── Variance Table ──
function updateVarianceTable() {
  const s = getS();
  const rows = [
    { label: 'Revenue ($M)', int: s.revenue, con: CONSENSUS.revenue },
    { label: 'Semi Systems', int: s.semi, con: CONSENSUS.semi },
    { label: 'AGS', int: s.ags, con: CONSENSUS.ags },
    { label: 'Diluted EPS', int: s.eps, con: CONSENSUS.eps, isDollar: true },
  ];

  let html = '';
  rows.forEach(r => {
    html += '<tr><td>' + r.label + '</td>';
    for (let i = 0; i < 3; i++) {
      const diff = r.isDollar
        ? (r.int[i] - r.con[i]).toFixed(2)
        : fmt(r.int[i] - r.con[i]);
      const pctDiff = ((r.int[i] / r.con[i] - 1) * 100).toFixed(1);
      const cls = r.int[i] >= r.con[i] ? 'var-positive' : 'var-negative';
      const sign = r.int[i] >= r.con[i] ? '+' : '';
      const val = r.isDollar ? '$' + r.int[i].toFixed(2) : '$' + fmt(r.int[i]);
      html += `<td>${val} <span style="color:${cls === 'var-positive' ? 'var(--green)' : 'var(--red)'};font-size:10px">(${sign}${pctDiff}%)</span></td>`;
    }
    html += '</tr>';
  });
  document.getElementById('varianceBody').innerHTML = html;
}

// ══════════════════════════════════════════
//  SCENARIO SWITCHING
// ══════════════════════════════════════════

function switchCase(caseName) {
  currentCase = caseName;
  const s = getS();

  // Update buttons
  document.querySelectorAll('.scenario-btn').forEach(btn => {
    btn.className = 'scenario-btn';
    if (btn.dataset.case === caseName) {
      btn.classList.add('active-' + caseName);
    }
  });

  // Update KPIs
  const upside = ((s.target / CURRENT_PRICE - 1) * 100).toFixed(1);
  const upsidePositive = s.target > CURRENT_PRICE;
  document.getElementById('kpiTarget').textContent = '$' + s.target;
  document.getElementById('kpiTarget').style.color = upsidePositive ? 'var(--green)' : 'var(--red)';
  document.getElementById('kpiUpside').textContent = (upsidePositive ? '+' : '') + upside + '% upside';
  document.getElementById('kpiEPS').textContent = '$' + s.eps[2].toFixed(2);
  document.getElementById('kpiPE').textContent = s.pe + 'x P/E';

  const rev28 = (s.revenue[2] / 1000).toFixed(1);
  const revGr = ((s.revenue[2] / s.revenue[1] - 1) * 100).toFixed(1);
  document.getElementById('kpiRev').textContent = '$' + rev28 + 'B';
  document.getElementById('kpiRevGrowth').textContent = '+' + revGr + '% yoy';

  const rev27Gr = ((s.revenue[1] / 28368 - 1) * 100).toFixed(1);
  document.getElementById('kpiRev27').textContent = rev27Gr + '%';
  document.getElementById('kpiRev27Sub').textContent = 'vs. consensus 11.8%';

  // Header
  document.getElementById('headerTarget').textContent = '$' + s.target;
  document.getElementById('headerTarget').style.color = upsidePositive ? 'var(--green)' : 'var(--red)';
  document.getElementById('headerUpside').textContent = (upsidePositive ? '+' : '') + upside + '%';
  document.getElementById('headerUpside').className = 'upside-badge ' + (upsidePositive ? 'positive' : 'negative');

  // Tags
  document.getElementById('tagRevBuild').textContent = s.label;
  document.getElementById('tagEPS').textContent = s.label;
  document.getElementById('tagSemi').textContent = s.label;
  document.getElementById('tagMargin').textContent = s.label;

  // Destroy and recreate charts
  Object.keys(charts).forEach(k => {
    if (charts[k] && k !== 'geo' && k !== 'football' && k !== 'peerPE' && k !== 'overlay' && k !== 'drivers') {
      charts[k].destroy();
    }
  });

  initRevBuild();
  initConsensus();
  initEPS();
  initSemiMix();
  initMargins();
  updateVarianceTable();
}

// ══════════════════════════════════════════
//  BOOT
// ══════════════════════════════════════════

document.addEventListener('DOMContentLoaded', initCharts);
</script>
</body>
</html>
